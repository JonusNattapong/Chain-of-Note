# คู่มือระบบ Chain-of-Note RAG (ฉบับภาษาไทย)

เอกสารนี้ให้ภาพรวมโดยละเอียดเกี่ยวกับสถาปัตยกรรม ส่วนประกอบ และขั้นตอนการทำงานของระบบ Chain-of-Note RAG

## สถาปัตยกรรมระบบ

ระบบ Chain-of-Note RAG ได้รับการออกแบบมาเพื่อปรับปรุงความถูกต้องและลดอาการหลอน (Hallucinations) ในคำตอบที่สร้างโดย AI โดยการเพิ่มขั้นตอนการจดบันทึก ระบบประกอบด้วยส่วนประกอบหลักดังต่อไปนี้:

1.  **Document Loader:** รับผิดชอบในการโหลดเอกสารจากแหล่งต่างๆ และแบ่งออกเป็นส่วนย่อยๆ เพื่อให้ง่ายต่อการประมวลผล
2.  **Embedding Model:** สร้างเวกเตอร์ (Embeddings) ของเอกสารและคำถามของผู้ใช้ เวกเตอร์เหล่านี้จับความหมายเชิงความหมายของข้อความ
3.  **Document Store:** ฐานข้อมูลเวกเตอร์ที่จัดเก็บ Embeddings ของเอกสารและมีความสามารถในการค้นหาความคล้ายคลึงกันอย่างมีประสิทธิภาพเพื่อดึงเอกสารที่เกี่ยวข้องกับคำถามที่กำหนด
4.  **Chain-of-Note:** ส่วนประกอบนี้ใช้ตรรกะหลักของระบบ โดยจะรับคำถามของผู้ใช้และเอกสารที่ดึงมาเป็นข้อมูลป้อนเข้า สร้างบันทึกขั้นกลางตามเอกสาร จากนั้นใช้บันทึกเหล่านี้เพื่อสร้างคำตอบสุดท้าย
5.  **RAG System:** คลาสหลัก (`ChainOfNoteRAG`) ที่ประสานงานกระบวนการทั้งหมด ตั้งแต่การรับคำถามของผู้ใช้ไปจนถึงการสร้างคำตอบสุดท้าย

## ขั้นตอนการทำงาน

ระบบทำงานตามขั้นตอนต่อไปนี้:

1.  **การนำเข้าเอกสาร:**
    *   เอกสารจะถูกโหลดโดยใช้ `DocumentLoader`
    *   `DocumentLoader` จะแบ่งเอกสารออกเป็นส่วนย่อยๆ
    *   `EmbeddingModel` สร้าง Embeddings สำหรับแต่ละส่วนย่อย
    *   ส่วนย่อยและ Embeddings จะถูกจัดเก็บไว้ใน `DocumentStore`

2.  **การประมวลผลคำถาม:**
    *   ผู้ใช้ส่งคำถาม
    *   `EmbeddingModel` สร้าง Embedding สำหรับคำถาม
    *   `DocumentStore` ค้นหาเอกสารที่มี Embeddings คล้ายกับ Embedding ของคำถาม
    *   เอกสารที่เกี่ยวข้องมากที่สุด k อันดับแรกจะถูกดึงออกมา
    *   ส่วนประกอบ `ChainOfNote` สร้างบันทึกตามเอกสารที่ดึงมาและคำถาม
    *   ส่วนประกอบ `ChainOfNote` สร้างคำตอบสุดท้ายตามบันทึกที่สร้างขึ้น
    *   ระบบจะส่งคืนคำตอบ และอาจรวมถึงบันทึกที่สร้างขึ้นและเอกสารที่ดึงมา (บริบท)

## แผนภาพขั้นตอนการทำงาน

https://www.mermaidchart.com/raw/7c1afbd8-24c8-4681-9a80-a877bebd1b63?theme=light&version=v0.1&format=svg

## ส่วนประกอบโดยละเอียด

*   **`src/rag_system.py`:** ประกอบด้วยคลาส `ChainOfNoteRAG` ซึ่งเป็นจุดเริ่มต้นหลักสำหรับระบบ
*   **`src/chain_of_note.py`:** ประกอบด้วยคลาส `ChainOfNote` ซึ่งรับผิดชอบในการสร้างบันทึกและการสังเคราะห์คำตอบ
*   **`src/embeddings.py`:** ประกอบด้วยอินเทอร์เฟซ `EmbeddingModel` และการใช้งาน (เช่น `SentenceTransformerEmbeddings`)
*   **`src/document_store.py`:** ประกอบด้วยคลาส `DocumentStore` ซึ่งจัดการการจัดเก็บและดึงข้อมูลเอกสาร
*   **`src/data_loader.py`:** ประกอบด้วยคลาส `DocumentLoader` ซึ่งรับผิดชอบในการโหลดและประมวลผลเอกสารล่วงหน้า